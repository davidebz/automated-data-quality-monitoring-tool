<!--
SPDX-FileCopyrightText: 2024 Catch Solve di Davide Montesin

SPDX-License-Identifier: AGPL-3.0-or-later
-->

<!-- * (C) 2024 Catch Solve di Davide Montesin * License: AGPL -->
<checks>


	<check>
		<name>GpsInfo must be not 0,0</name>
		<category>GpsInfo must be not 0,0</category>
		<description>
			This rule checks that if GPS information is provided as a list, all entries in that list have valid coordinates (i.e., latitude and longitude are not 0).
			If there is no list (GpsInfo is not an array), the rule automatically passes.
		</description>
		<data_scope_filters>
			<!-- dataset shortname, if * is tested on all datasets -->
			<dataset_shortname>Museums</dataset_shortname>
			<dataset_dataspace>tourism</dataset_dataspace>
		</data_scope_filters>
		<data_quality_rule>
			<!-- which programming language the rule is written. at the moment supported javascript and jsonlogic -->
			<rule_language>javascript</rule_language>
			<rule_expression><![CDATA[

				!Array.isArray($.GpsInfo) || $.GpsInfo.every($ => $.Latitude != 0 && $.Longitude != 0)

			]]></rule_expression>
		</data_quality_rule>
	</check>

	<check>
	
		<name>mvalue gt zero2</name>
		<category>mvalue gt zero2</category>
		<description>
			mvalue gt zero
		</description>

		<data_scope_filters>

			<dataset_shortname></dataset_shortname>
			<dataset_dataspace>environmental</dataset_dataspace>
			<dataset_apitype>timeseries</dataset_apitype>

			<!-- sactive.eq.true -->
			<!-- last hours, last day, week, minute o latest -->
			<!--
			<additional_url_parameters>/EAQI-NO2/latest?where=mperiod.eq.3600</additional_url_parameters>
			-->

			<apitype_timeseries_param_datatype>EAQI-NO2</apitype_timeseries_param_datatype>
			<apitype_timeseries_param_mperiod>3600</apitype_timeseries_param_mperiod>
			<apitype_timeseries_param_last_from_hours>24</apitype_timeseries_param_last_from_hours>
			<apitype_timeseries_param_last_to_hours>0</apitype_timeseries_param_last_to_hours>

		</data_scope_filters>

		<data_quality_rule>
			<rule_language>javascript</rule_language>
			<rule_expression><![CDATA[
			
				$.mvalue > 10

			]]></rule_expression>
		</data_quality_rule>
	</check>



</checks>
