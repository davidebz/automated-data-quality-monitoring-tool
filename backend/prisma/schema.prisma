generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model rules {
  id                       String   @id @default(dbgenerated("gen_random_uuid()"))
  name                     String
  datasetname_searchfilter String
  searchfilter             String
  type                     String
  value                    String
  createdat                DateTime @default(now()) @db.Timestamptz(6)
}

model test_dataset {
  id                 BigInt               @unique @default(autoincrement())
  session_start_ts   DateTime             @db.Timestamptz(6)
  dataset_name       String
  tested_records     Int                  @default(0)
  dataset_img_url    String               @default("")
  errors             String?
  dataset_dataspace  String?
  used_key           String?
  test_dataset_check test_dataset_check[]

  @@id([session_start_ts, dataset_name])
  @@unique([session_start_ts, dataset_name], map: "session_start_ts_dataset_name_unique")
}

model test_dataset_check {
  id               BigInt       @unique @default(autoincrement())
  session_start_ts DateTime     @db.Timestamptz(6)
  dataset_name     String
  check_name       String
  test_dataset     test_dataset @relation(fields: [session_start_ts, dataset_name], references: [session_start_ts, dataset_name], onDelete: NoAction, onUpdate: NoAction, map: "test_dataset_check_session_start_ts_fkey")

  @@id([session_start_ts, dataset_name, check_name])
  @@map("test_dataset_check")
}

model test_dataset_record_check_failed {
  id                       BigInt   @unique(map: "test_dataset_record_attribute_check_fail_id_key") @default(autoincrement())
  session_start_ts         DateTime @db.Timestamptz(6)
  dataset_name             String
  record_jsonpath          String
  check_name               String
  record_json              String
  impacted_attributes_csv  String
  check_category           String
  problem_hint             String
  used_key                 String?
  impacted_attribute_value String?

  @@index([session_start_ts, dataset_name, check_category, check_name], map: "test_dataset_record_check_fai_session_start_ts_dataset_name_idx")
  @@map("test_dataset_record_check_failed")
}
